N = 5   # markout days
    ndf = pd.read_csv("D:/data/CRB/enriched_trades_file.csv")
    ynames = ['sgn_ret_{}'.format(i) for i in range(N+1)]
    qq = np.ones(ndf.shape[0]).astype(bool)

    all = uda.summarize(ndf[qq], by=['one'], ynames=ynames, weight='absval')
    byside = uda.summarize(ndf[qq], by=['side'], ynames=ynames, weight='absval')

    # note that groupby can group by a lambda function, i used that to create groups
    # on the fly, particularly for all sample
    # aggregation function can also be lambda function
    aggregations = {
        'ordervalue': [len, 'sum'],
        'executedvalue': ['sum'],
        'qdone': [lambda x: 1.0 - (np.sum(x > 0) / len(x))]
    }
    ndf.groupby(lambda x: 'ALL').agg(aggregations)
